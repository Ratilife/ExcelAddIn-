# ExcelAddInЭкспортДанных

Надстройка для Microsoft Excel, предоставляющая расширенные возможности экспорта данных в различные форматы.

## Описание

ExcelAddInЭкспортДанных — это VSTO (Visual Studio Tools for Office) надстройка для Excel, которая расширяет стандартные возможности экспорта данных. Надстройка позволяет экспортировать данные из Excel в различные форматы файлов, а также предоставляет дополнительные инструменты для работы с данными.

## Основные возможности

### Экспорт данных

- **CSV** — экспорт в формат CSV с настраиваемым разделителем и кодировкой
- **PDF** — экспорт листов и диапазонов в PDF
- **TXT** — экспорт в текстовый формат
- **JSON** — экспорт данных в формат JSON
- **XML** — экспорт в XML формат
- **HTML** — экспорт в HTML
- **XLS/XLSM** — экспорт в старые форматы Excel

### Дополнительные функции

- Импорт CSV в XLSX
- Генерация QR-кодов на основе данных
- Работа с JSON структурами таблиц
- Создание таблиц в Excel программно
- SQL-запросы к данным Excel

## Требования

- Microsoft Excel 2010 или выше
- .NET Framework 4.8
- Visual Studio Tools for Office Runtime (VSTO Runtime 4.0)

## Технологии

- **.NET Framework 4.8**
- **VSTO (Visual Studio Tools for Office)**
- **EPPlus 7.4.1** — для работы с Excel файлами
- **Newtonsoft.Json 13.0.3** — для работы с JSON
- **ZXing.Net 0.16.9** — для генерации QR-кодов

## Структура проекта

```
ExcelAddInЭкспортДанных/
├── classes/                  # Основные классы функциональности
│   ├── CommonMethods.cs      # Общие вспомогательные методы
│   ├── ExportData.cs         # Класс для экспорта данных
│   ├── QRcode.cs             # Генерация QR-кодов
│   ├── RequestGeneration.cs  # SQL-запросы к данным
│   ├── WorkingJSON.cs        # Работа с JSON
│   └── WorkingWithTables.cs  # Работа с таблицами Excel
├── forms/                    # Формы пользовательского интерфейса
│   ├── ExportCsvToXlsx.cs    # Импорт CSV в XLSX
│   ├── ExportXlsxToCsv.cs    # Экспорт XLSX в CSV
│   ├── ExportXlsxToDF.cs     # Экспорт в различные форматы
│   └── FormDialogTableStructureJASON_Sample.cs
├── UserControl/              # Пользовательские элементы управления
│   ├── QRControl.cs          # Элемент управления для QR-кодов
│   └── TableСreationForm.cs  # Форма создания таблиц
├── Resources/                # Ресурсы (иконки и изображения)
├── Ribbon.xml                # Определение ленты Excel
├── MyCustomRibbonExportFeed.cs  # Обработчики событий ленты
└── ThisAddIn.cs              # Точка входа надстройки
```

## Установка

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
```

2. Откройте решение `ExcelAddInЭкспортДанных.sln` в Visual Studio

3. Восстановите NuGet пакеты:
```bash
nuget restore
```

4. Соберите проект в режиме Release или Debug

5. Установите надстройку:
   - Для разработки: запустите проект из Visual Studio (F5)
   - Для распространения: используйте созданный установщик или скопируйте собранные файлы в папку надстроек Excel

## Использование

После установки надстройки в Excel появится новая вкладка **"RatiTools"** на ленте с группой **"Экспорт данных"**.

### Основные операции

1. **Экспорт в CSV**: Нажмите кнопку "Экспорт в CSV" для экспорта активного листа или всей книги
2. **Экспорт в PDF**: Используйте кнопку "Экспорт в PDF" для создания PDF файлов
3. **Экспорт в TXT**: Кнопка "Экспорт в TXT" для текстового экспорта
4. **Другие форматы**: Используйте диалоговое окно для доступа к дополнительным форматам (JSON, XML, HTML и др.)

### Настройки экспорта

- Выбор кодировки (UTF-8, Windows-1251 и др.)
- Настройка разделителей для CSV
- Выбор диапазона данных (активный лист, выделенный диапазон, вся книга)
- Автоматическое открытие файлов после экспорта

## Разработка

### Сборка проекта

```bash
msbuild ExcelAddInЭкспортДанных.sln /p:Configuration=Release
```

### Отладка

1. Установите точку останова в коде
2. Нажмите F5 в Visual Studio
3. Excel откроется с загруженной надстройкой
4. Выполните действия для вызова отлаживаемого кода

## Зависимости

Основные зависимости указаны в `packages.config`:

- EPPlus (7.4.1)
- EPPlus.Interfaces (6.1.1)
- EPPlus.System.Drawing (6.1.1)
- Newtonsoft.Json (13.0.3)
- ZXing.Net (0.16.9)
- Microsoft.IO.RecyclableMemoryStream (3.0.1)

## Лицензия

[Укажите лицензию, если применимо]

## Авторы

[Укажите авторов проекта]

## Поддержка

[Укажите контакты для поддержки или ссылку на issues]
